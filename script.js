const isMainPage="/"===window.location.pathname||window.location.pathname.endsWith("index.html")||window.location.pathname.endsWith("/"),isTranslatablePage=isMainPage||window.location.pathname.includes("privacy-policy.html")||window.location.pathname.includes("terms-of-use.html");function safeGetLocalStorage(e,t){try{if("undefined"!=typeof Storage&&"undefined"!=typeof localStorage&&window.localStorage){const n=localStorage.getItem(e);return null!==n?n:t}}catch(e){if("QuotaExceededError"!==e.name&&"SecurityError"!==e.name&&"NS_ERROR_DOM_SECURITY_ERR"!==e.name)console.warn("localStorage access error:",e)}return t}function safeSetLocalStorage(e,t){try{if("undefined"!=typeof Storage&&"undefined"!=typeof localStorage&&window.localStorage){localStorage.setItem(e,t);return!0}}catch(e){if("QuotaExceededError"!==e.name&&"SecurityError"!==e.name&&"NS_ERROR_DOM_SECURITY_ERR"!==e.name)console.warn("localStorage write error:",e)}return!1}let burgerMenu,nav,langButtons,elementsWithI18n,appointmentForm,currentLanguage="uk";currentLanguage=isTranslatablePage?safeGetLocalStorage("language","uk"):"uk";let navOverlay=null;function updateBodyPadding(){const e=document.querySelector(".header");if(e){const{height:t}=e.getBoundingClientRect();document.body.style.paddingTop=`${t}px`}}function initializeApp(){burgerMenu=document.getElementById("burgerMenu"),nav=document.getElementById("nav"),langButtons=document.querySelectorAll(".lang-btn"),appointmentForm=document.getElementById("appointmentForm"),elementsWithI18n=document.querySelectorAll("[data-i18n]");const e=document.querySelector(".hero-title");e&&(e.style.opacity="1",e.style.visibility="visible"),updateBodyPadding();const t=document.querySelector(".header");if(t&&"undefined"!=typeof ResizeObserver){new ResizeObserver(()=>{updateBodyPadding()}).observe(t)}window.addEventListener("resize",updateBodyPadding),updateSubtitleWidth(),window.addEventListener("resize",updateSubtitleWidth),updateActiveLangButton(),isTranslatablePage?(setLanguage(currentLanguage),updateActiveLangButton(),updateLanguageSelect()):setLanguage("uk"),setupBurgerMenu()}function updateSubtitleWidth(){const e=document.querySelector(".hero-subtitle1"),t=document.querySelector(".hero-subtitle2");if(e&&t&&window.innerWidth>=480){const n=e.offsetWidth;t.style.maxWidth=n+"px"}else t&&(t.style.maxWidth="")}if("loading"===document.readyState?document.addEventListener("DOMContentLoaded",updateBodyPadding):updateBodyPadding(),window.addEventListener("load",()=>{updateBodyPadding(),setTimeout(updateBodyPadding,100)}),"undefined"!=typeof ResizeObserver){const e=new ResizeObserver(()=>{updateSubtitleWidth()});if("loading"===document.readyState)document.addEventListener("DOMContentLoaded",()=>{const t=document.querySelector(".hero-subtitle1");t&&e.observe(t)});else{const t=document.querySelector(".hero-subtitle1");t&&e.observe(t)}}function createNavOverlay(){const e=document.createElement("div");return e.className="nav-overlay",document.body?(document.body.appendChild(e),e):null}function setupBurgerMenu(){if(burgerMenu||(burgerMenu=document.getElementById("burgerMenu")),nav||(nav=document.getElementById("nav")),navOverlay||(navOverlay=createNavOverlay()),!burgerMenu||!nav||!navOverlay)return void setTimeout(setupBurgerMenu,100);if("true"===burgerMenu.dataset.burgerInitialized)return;burgerMenu.dataset.burgerInitialized="true";const e=e=>{e&&e.stopPropagation();const t=burgerMenu.classList.toggle("active");nav.classList.toggle("active",t),navOverlay.classList.toggle("active",t),document.body.style.overflow=t?"hidden":"",t?document.body.classList.add("menu-open"):document.body.classList.remove("menu-open"),setTimeout(updateBodyPadding,50)};burgerMenu.addEventListener("click",e,{passive:!1}),burgerMenu.addEventListener("touchend",t=>{t.preventDefault(),e(t)},{passive:!1}),navOverlay.addEventListener("click",()=>{burgerMenu.classList.remove("active"),nav.classList.remove("active"),navOverlay.classList.remove("active"),document.body.classList.remove("menu-open"),document.body.style.overflow="",setTimeout(updateBodyPadding,50)})}function setupNavLinks(){if(!burgerMenu||!nav||!navOverlay)return;document.querySelectorAll(".nav-link").forEach(e=>{e.addEventListener("click",()=>{burgerMenu.classList.remove("active"),nav.classList.remove("active"),navOverlay.classList.remove("active"),document.body.classList.remove("menu-open"),document.body.style.overflow="",setTimeout(updateBodyPadding,50)})}),document.addEventListener("keydown",e=>{"Escape"===e.key&&nav&&nav.classList.contains("active")&&(burgerMenu.classList.remove("active"),nav.classList.remove("active"),navOverlay.classList.remove("active"),document.body.classList.remove("menu-open"),document.body.style.overflow="",setTimeout(updateBodyPadding,50))})}function setupLangButtons(){if(!langButtons||0===langButtons.length)return;if(!isTranslatablePage)return;langButtons.forEach(e=>{e.addEventListener("click",()=>{const t=e.getAttribute("data-lang");setLanguage(t),updateActiveLangButton(),updateLanguageSelect(),safeSetLocalStorage("language",t),document.documentElement.lang=t})});const e=document.getElementById("languageSelect");e&&isTranslatablePage&&e.addEventListener("change",()=>{const t=e.value;setLanguage(t),updateActiveLangButton(),updateLanguageSelect(),safeSetLocalStorage("language",t),document.documentElement.lang=t})}function updateLanguageSelect(){const e=document.getElementById("languageSelect");e&&(e.value=currentLanguage)}function updateActiveLangButton(){langButtons&&0!==langButtons.length&&langButtons.forEach(e=>{e.getAttribute("data-lang")===currentLanguage?e.classList.add("active"):e.classList.remove("active")})}function setLanguage(e){isTranslatablePage||(e="uk"),currentLanguage=e,elementsWithI18n=document.querySelectorAll("[data-i18n]");const t=document.querySelectorAll(".nav-item-uk-only");t.length>0&&("uk"===e?t.forEach(e=>{e.style.display=""}):t.forEach(e=>{e.style.display="none"}));const n=document.querySelectorAll(".uk-only");n.length>0&&("uk"===e?n.forEach(e=>{e.style.display=""}):n.forEach(e=>{e.style.display="none"}));const a=document.querySelector("section.about");a&&(a.style.display="uk"===e?"":"none"),elementsWithI18n.forEach(t=>{const n=t.getAttribute("data-i18n"),a=getTranslation(n,e);if(a)if("logo"===n);else if("INPUT"===t.tagName&&"submit"===t.type)t.value=a;else if("INPUT"===t.tagName||"TEXTAREA"===t.tagName)if(t.hasAttribute("data-i18n-label")){const n=getTranslation(t.getAttribute("data-i18n-label"),e);if(n){t.setAttribute("aria-label",n);const e=document.querySelector(`label.form-label[for="${t.id}"]`);e&&(e.textContent=n)}if(t.hasAttribute("data-i18n-placeholder")){const n=getTranslation(t.getAttribute("data-i18n-placeholder"),e);n&&t.setAttribute("placeholder",n)}}else t.placeholder=a;else{const e=t.querySelector(".flag-icon-wrapper"),n=t.querySelector(".pt-flag-wrapper"),o=t.querySelectorAll(".flag-icon"),l=t.classList.contains("hero-title"),r=t.classList.contains("hero-subtitle");if(l)if(a.includes("<")&&(a.includes("</")||a.includes("/>"))){t.innerHTML=a;t.querySelectorAll('img[src*="flag-simple.svg"]').forEach(e=>{e.setAttribute("loading","eager")})}else t.innerHTML=a+' <span class="flag-icon-wrapper"></span>';else if(r){if(a){t.innerHTML=a;t.querySelectorAll("img.flag-icon-inline").forEach(e=>{e.setAttribute("loading","eager"),e.setAttribute("width","20"),e.setAttribute("height","14"),e.style.display="inline-block",e.style.verticalAlign="middle",e.style.marginLeft="4px"})}}else if(e){const n=e.cloneNode(!0),o=document.createTextNode(a+" ");t.innerHTML="",t.appendChild(o),t.appendChild(n)}else if(n){const e=n.cloneNode(!0),o=document.createTextNode(a+" ");t.innerHTML="",t.appendChild(o),t.appendChild(e)}else if(o.length>0){const e=document.createTextNode(a+" ");t.innerHTML="",t.appendChild(e),o.forEach(e=>t.appendChild(e))}else"A"===t.tagName?t.textContent=a:a.includes("<")&&(a.includes("</")||a.includes("/>"))||a.includes("&")&&(a.includes("&shy;")||a.includes("&nbsp;")||a.includes("&amp;")||a.includes("&lt;")||a.includes("&gt;")||a.includes("&quot;"))?t.innerHTML=a:t.textContent=a}else if(t.classList.contains("feature-text")){const e=t.closest(".feature-item");e&&(e.style.display="none")}});document.querySelectorAll(".feature-item").forEach(t=>{const n=t.querySelector(".feature-text[data-i18n]");if(n){const a=getTranslation(n.getAttribute("data-i18n"),e);a&&""!==a.trim()?t.style.display="":t.style.display="none"}});const o=document.querySelector("#successMessage .success-text");if(o){const t=getTranslation("appointment.form.success",e);t&&(o.textContent=t)}document.documentElement.lang=e,setTimeout(()=>{updateSubtitleWidth()},100)}function getTranslation(e,t){const n=e.split(".");let a=translations[t];for(const e of n){if(!a||"object"!=typeof a)return null;a=a[e]}return a}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",initializeApp):initializeApp(),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",setupNavLinks):setupNavLinks(),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",setupLangButtons):setupLangButtons(),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){const t=this.getAttribute("href");if("#"!==t&&""!==t){e.preventDefault();const n=document.querySelector(t);if(n){const e=80,t=n.getBoundingClientRect().top+window.pageYOffset-e;window.scrollTo({top:t,behavior:"smooth"})}}})});const header=document.getElementById("header");function validateEmail(e){if(!e.includes("@"))return!1;const t=e.split("@");if(2!==t.length)return!1;const[n,a]=t;if(!n||0===n.length||n.length>64)return!1;if(!a||0===a.length)return!1;if(!a.includes("."))return!1;const o=a.split("."),l=o[o.length-1];return!(!l||l.length<2)&&/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*\.[a-zA-Z]{2,}$/.test(e)}function validatePhone(e){const t=e.replace(/\D/g,"");return t.length>=10&&t.length<=12}function showError(e,t){const n=document.getElementById(`${e}-error`),a=document.getElementById(e);n&&a&&(n.textContent=t,a.classList.add("invalid"))}function clearError(e){const t=document.getElementById(`${e}-error`),n=document.getElementById(e);t&&n&&(t.textContent="",n.classList.remove("invalid"))}function checkFieldValidity(e,t,n,a,o){return t&&t.trim()?n&&!n(t)?{isValid:!1,message:o}:{isValid:!0}:{isValid:!1,message:a}}function validateForm(e=!1){const t=document.getElementById("fullname"),n=document.getElementById("phone"),a=document.getElementById("email"),o=document.getElementById("terms");let l=!0;const r=checkFieldValidity("fullname",t?.value,null,"uk"===currentLanguage?"Поле ПІБ обов'язкове для заповнення":"en"===currentLanguage?"Full name is required":"Nome completo é obrigatório","");r.isValid?e&&clearError("fullname"):(e&&showError("fullname",r.message),l=!1);const i=checkFieldValidity("phone",n?.value,validatePhone,"uk"===currentLanguage?"Поле телефону обов'язкове для заповнення":"en"===currentLanguage?"Phone number is required":"Número de telefone é obrigatório","uk"===currentLanguage?"Введіть коректний номер телефону":"en"===currentLanguage?"Please enter a valid phone number":"Por favor, insira um número de telefone válido");i.isValid?e&&clearError("phone"):(e&&showError("phone",i.message),l=!1);const d=checkFieldValidity("email",a?.value,validateEmail,"uk"===currentLanguage?"Поле email обов'язкове для заповнення":"en"===currentLanguage?"Email is required":"Email é obrigatório","uk"===currentLanguage?"Введіть коректну email адресу":"en"===currentLanguage?"Please enter a valid email address":"Por favor, insira um endereço de email válido");return d.isValid?e&&clearError("email"):(e&&showError("email",d.message),l=!1),o&&o.checked||(l=!1),l}header&&window.addEventListener("scroll",()=>{const e=window.pageYOffset;header.style.boxShadow=e>100?"0 4px 20px rgba(0, 0, 0, 0.15)":"0 2px 10px rgba(0, 0, 0, 0.1)"}),appointmentForm&&appointmentForm.addEventListener("submit",e=>{if(e.preventDefault(),clearError("fullname"),clearError("phone"),clearError("email"),!validateForm(!0))return;const t=new FormData(appointmentForm),n=document.getElementById("submitBtn"),a=document.getElementById("successMessage");if(n){n.disabled=!0;const e="uk"===currentLanguage?"Відправка...":"en"===currentLanguage?"Sending...":"Enviando...";n.textContent=e}fetch("send_email.php",{method:"POST",body:t}).then(e=>{if(!e.ok)throw new Error("Network response was not ok");return e.json()}).then(e=>{if(e.success){if(a){const t=a.querySelector(".success-text");t&&(t.textContent=e.message),a.classList.add("show")}appointmentForm.reset(),clearError("fullname"),clearError("phone"),clearError("email"),setTimeout(()=>{a&&a.classList.remove("show")},5e3)}else alert(e.message||"Помилка відправки. Будь ласка, спробуйте пізніше.")}).catch(e=>{console.error("Error:",e),alert("Помилка відправки. Будь ласка, спробуйте пізніше або зв'яжіться з нами безпосередньо.")}).finally(()=>{if(n){n.disabled=!1;const e=getTranslation("appointment.form.submit",currentLanguage);n.textContent=e||"Відправити"}})});const scrollToTopButton=document.getElementById("scrollToTop");function toggleScrollToTopButton(){if(!scrollToTopButton)return;const e=window.scrollY,t=window.innerHeight;e>Math.max(.5*t,500)?scrollToTopButton.classList.add("visible"):scrollToTopButton.classList.remove("visible")}function downloadPDF(){const e="files/recipies.pdf",t="ukrainska-molochna-drabyna-recepty.pdf";fetch(e).then(e=>e.blob()).then(e=>{const n=window.URL.createObjectURL(e),a=document.createElement("a");a.href=n,a.download=t,document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(n),document.body.removeChild(a)}).catch(n=>{const a=document.createElement("a");a.href=e,a.download=t,a.target="_blank",document.body.appendChild(a),a.click(),document.body.removeChild(a)})}function downloadMolochnaImage(){fetch("assets/images/molochna-drabyna/2400x1350_1.webp").then(e=>{if(!e.ok)throw new Error("WebP not available");return e.blob()}).then(e=>{const t=window.URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download="ukrainska-molochna-drabyna.webp",document.body.appendChild(n),n.click(),window.URL.revokeObjectURL(t),document.body.removeChild(n)}).catch(e=>{const t=document.getElementById("molochnaDrabynaImg"),n=t&&t.src.includes(".jpg")?t.src:"assets/images/molochna-drabyna/2400x1350.jpg",a=document.createElement("a");a.href=n,a.download="ukrainska-molochna-drabyna.jpg",a.target="_blank",document.body.appendChild(a),a.click(),document.body.removeChild(a)})}function initMolochnaDownload(){const e=document.getElementById("molochnaDrabynaClickable"),t=document.getElementById("downloadRecipesBtn"),n=document.getElementById("recipesImageClickable");e&&e.addEventListener("click",downloadMolochnaImage);const a=document.querySelector(".molochna-image-overlay");a&&e&&(a.style.pointerEvents="auto",a.addEventListener("click",function(e){e.stopPropagation(),downloadMolochnaImage()})),t&&t.addEventListener("click",downloadPDF),n&&n.addEventListener("click",downloadPDF);const o=document.querySelector(".recipes-image-overlay");o&&n&&(o.style.pointerEvents="auto",o.addEventListener("click",function(e){e.stopPropagation(),downloadPDF()}))}scrollToTopButton&&(window.addEventListener("scroll",toggleScrollToTopButton),window.addEventListener("load",toggleScrollToTopButton),scrollToTopButton.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})})),document.addEventListener("DOMContentLoaded",function(){initMolochnaDownload()});function openAppointmentModal(){const e=document.getElementById("appointmentModal");e&&(e.classList.add("active"),document.body.style.overflow="hidden",document.body.classList.add("modal-open"))}function closeAppointmentModal(){const e=document.getElementById("appointmentModal");e&&(e.classList.remove("active"),document.body.style.overflow="",document.body.classList.remove("modal-open"))}function setupAppointmentModal(){const e=document.querySelectorAll(".appointment-modal-trigger"),t=document.getElementById("appointmentModal"),n=document.getElementById("modalClose"),a=document.querySelectorAll(".modal-btn");e.forEach(e=>{e.addEventListener("click",function(t){t.preventDefault(),openAppointmentModal()})}),n&&n.addEventListener("click",closeAppointmentModal),t&&t.addEventListener("click",function(e){e.target===t&&closeAppointmentModal()}),a.forEach(e=>{e.addEventListener("click",function(){closeAppointmentModal()})}),document.addEventListener("keydown",function(e){"Escape"===e.key&&t&&t.classList.contains("active")&&closeAppointmentModal()})}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",setupAppointmentModal):setupAppointmentModal();